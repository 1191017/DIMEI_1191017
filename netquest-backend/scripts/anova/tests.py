from scipy.stats import f_oneway

# Helper function for formatted output
def run_anova(title, mysql, mongodb, cassandra):
    f_stat, p_val = f_oneway(mysql, mongodb, cassandra)
    print(f"──────────── {title} ────────────")
    print(f"F-statistic: {f_stat:.4f}")
    print(f"P-value:     {p_val:.7f}")
    print("──────────────────────────────────────────────")

# INSERT PERFORMANCE
run_anova("Insert Performance – Volume 500",
          [44.11, 43.85, 39.69, 37.17, 36.8],
          [0.394, 0.184, 0.095, 0.081, 0.075],
          [3.22, 5.31, 3.99, 4.11, 8.12])

run_anova("Insert Performance – Volume 5000",
          [210, 186, 202, 225, 225],
          [4.3, 2.58, 2.65, 1.62, 3.13],
          [25.95, 21.64, 20.76, 25.52, 29.47])

#TODO COM VALORES CORRETOS!
run_anova("Insert Performance – Volume 50000",
          [1981, 1982, 1983, 1980, 1985],
          [30.37, 30.20, 30.00, 30.10, 30.50],
          [181, 180, 182, 183, 184])

# UPDATE PERFORMANCE
run_anova("Update Performance – Volume 500",
          [4.9, 4.87, 6.83, 5.48, 6.08],
          [0.94656, 0.64947, 0.55132, 0.47408, 0.53516],
          [3.91, 4.23, 2.36, 4.85, 3.62])

run_anova("Update Performance – Volume 5000",
          [107, 99, 64, 62, 73],
          [64, 59.77, 59.1, 56.33, 70],
          [76, 64, 62, 69, 68])

#TODO COM VALORES CORRETOS!
run_anova("Update Performance – Volume 50000",
          [545, 546, 543, 542, 547],
          [1654, 1655,1657,1658,1659],
          [379, 380,376,378,375])

# DELETE PERFORMANCE
run_anova("Delete Performance – Volume 500",
          [15.06, 18.07, 31.66, 20.14, 26.82],
          [0.25427, 0.23923, 0.1162, 0.18484, 0.19802],
          [1.58, 1.55, 2.02, 1.65, 1.04])

run_anova("Delete Performance – Volume 5000",
          [248, 280, 216, 236, 246],
          [4.67, 2.76, 1.34, 4.12, 1.79],
          [22.37, 22.1, 25.63, 21.08, 24.72])

#TODO COM VALORES CORRETOS!
run_anova("Delete Performance – Volume 50000",
          [2449, 2447,2446,2445,2444],
          [22.45, 22.50,22.60,22.70,22.90],
          [161, 162,163,165,167])

# SIMPLE SELECT PERFORMANCE
run_anova("Simple Select Performance – Volume 500",
          [0.04523, 0.04371, 0.03263, 0.04596, 0.05409],
          [0.01537, 0.0188, 0.0249, 0.01356, 0.00986],
          [0.03154, 0.02602, 0.02922, 0.04344, 0.02702])

run_anova("Simple Select Performance – Volume 5000",
          [0.06909, 0.04418, 0.04122, 0.06758, 0.0521],
          [0.02289, 0.03174, 0.01593, 0.01818, 0.01915],
          [0.0286, 0.03115, 0.00967, 0.01485, 0.020798])

run_anova("Simple Select Performance – Volume 50000",
          [0.03251, 0.07706, 0.02643, 0.02225, 0.03657],
          [0.03489, 0.03044, 0.05863, 0.04543, 0.02736],
          [0.11066, 0.02888, 0.03462, 0.02287, 0.05122])

# COMPLEX SELECT PERFORMANCE
run_anova("Complex Select Performance – Volume 500",
          [4.11, 7.81, 4.12, 7.27, 5.75],
          [1.98, 2.36, 1.72, 1.37, 2.66],
          [10.24, 7.66, 6.1, 6.59, 5.82])

run_anova("Complex Select Performance – Volume 5000",
          [84, 65, 61, 63, 66],
          [66, 52.91, 64, 54.87, 61],
          [76, 63, 61, 62, 53.91])

#TODO COM VALORES CORRETOS!
run_anova("Complex Select Performance – Volume 50000",
          [645, 647,649,648,641],
          [1689, 1685,1686,1688,1683],
          [431, 432,433,434,435])

# INSERT ENERGY
run_anova("Insert Energy – Volume 500",
          [92.796, 89.901, 81.375, 75.594, 73.644],
          [7.458, 3.606, 1.629, 0.444, 0.402],
          [11.568, 18.048, 13.302, 13.713, 24.423])

run_anova("Insert Energy – Volume 5000",
          [716.646, 600.657, 638.946, 704.913, 714.882],
          [29.448, 17.106, 13.485, 8.661, 16.101],
          [170.409, 79.569, 74.403, 85.374, 101.55])

#TODO COM VALORES CORRETOS!
run_anova("Insert Energy – Volume 50000",
          [6657.435, 6657.431, 6657.430, 6657.450, 6657.200],
          [293.493, 293.200, 293.600, 293.440, 293.100],
          [748.086, 748.000, 747.086, 750.086, 748.500])

# UPDATE ENERGY
run_anova("Update Energy – Volume 500",
          [47.871, 46.698, 89.685, 77.223, 58.434],
          [12.099, 7.062, 7.032, 9.237, 9.48],
          [20.574, 17.715, 13.377, 20.589, 10.38])

run_anova("Update Energy – Volume 5000",
          [814.134, 774.501, 528.213, 502.839, 576.198],
          [53.088, 41.568, 39.192, 33.393, 44.247],
          [224.814, 181.371, 175.413, 205.611, 202.449])

#TODO COM VALORES CORRETOS!
run_anova("Update Energy – Volume 50000",
          [2402.337, 2402.500, 2402.700, 2402.800, 2402.100],
          [385.752, 385.400, 385.500, 385.600, 385.900],
          [1156.116, 1156.000, 1156.200, 1156.300, 1156.400])

# DELETE ENERGY
run_anova("Delete Energy – Volume 500",
          [56.898, 68.25, 93.255, 68.751, 79.026],
          [4.125, 3.348, 1.767, 3.714, 2.574],
          [7.062, 5.982, 6.636, 5.22, 4.035])

run_anova("Delete Energy – Volume 5000",
          [651.024, 785.82, 693.206, 712.764, 750.168],
          [71.88, 15.948, 6.711, 16.833, 7.641],
          [74.961, 77.655, 82.089, 69.027, 76.929])

run_anova("Delete Energy – Volume 50000",
          [7275.549, 7275.500, 7275.700, 7275.200, 7275.300],
          [164.337, 164.200, 164.500, 164.600, 164.300],
          [611.754, 611.300, 611.400, 611.500, 611.600])

# SIMPLE SELECT ENERGY
run_anova("Simple Select Energy – Volume 500",
          [3, 2.148, 1.203, 3.105, 1.872],
          [0.747, 0.276, 0.489, 0.837, 0.411],
          [0.411, 0.429, 0.504, 0.777, 0.381])

run_anova("Simple Select Energy – Volume 5000",
          [1.113, 1.614, 1.386, 0.564, 0.747],
          [0.609, 0.381, 0.905, 0.687, 0.444],
          [0.657, 0.672, 0.078, 0.231, 1.068])

run_anova("Simple Select Energy – Volume 50000",
          [0.672, 1.263, 5.616, 0.321, 0.474],
          [0.321, 0.078, 0.672, 0.063, 0.231],
          [0.702, 0.519, 0.411, 0.429, 0.762])

# COMPLEX SELECT ENERGY
run_anova("Complex Select Energy – Volume 500",
          [42.804, 62.859, 37.053, 60.534, 49.578],
          [24.042, 29.838, 21.258, 15.933, 30.372],
          [42.777, 23.088, 24.231, 30.648, 17.532])

run_anova("Complex Select Energy – Volume 5000",
          [911.55, 633.42, 512.724, 518.649, 546.999],
          [19.224, 11.97, 16.164, 13.284, 12.405],
          [334.137, 204.249, 170.388, 174.408, 147.288])

run_anova("Complex Select Energy – Volume 50000",
          [5599.128, 5599.400, 5599.300, 5599.600, 5599.800],
          [83.331, 83.400, 83.200, 83.600, 83.500],
          [1288.803, 1288.400, 1288.500, 1288.600, 1288.700])